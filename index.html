<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Игровой калькулятор</title>
    <style>
        :root {
            --bg-dark: #0a0a0f;
            --card-bg: #12121a;
            --border-glow: rgba(255,255,255,0.1);
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --accent-yellow: #ffeb3b;
            --accent-red: #ff5722;
            --accent-purple: #9c27b0;
            --accent-blue: #2196f3;
            --accent-green: #4caf50;
            --accent-gray: #9e9e9e;
            --glow-yellow: 0 0 10px rgba(255,235,59,0.6);
            --glow-red: 0 0 10px rgba(255,87,34,0.6);
            --glow-purple: 0 0 10px rgba(156,39,176,0.6);
            --glow-blue: 0 0 10px rgba(33,150,243,0.6);
            --glow-green: 0 0 10px rgba(76,175,80,0.6);
            --glow-gray: 0 0 10px rgba(158,158,158,0.6);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--bg-dark);
            color: var(--text-primary);
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--accent-yellow), var(--accent-purple));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 5px rgba(255,255,255,0.3);
        }

        .add-item-btn {
            background: linear-gradient(to right, var(--accent-blue), var(--accent-purple));
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 12px rgba(33,150,243,0.5);
            transition: all 0.3s ease;
            margin-bottom: 20px;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .add-item-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 18px rgba(33,150,243,0.8);
        }

        .container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .item-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid var(--border-glow);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .item-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 87, 34, 0.2);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .delete-btn:hover {
            background: rgba(255, 87, 34, 0.4);
            opacity: 1;
        }

        .item-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .item-icon {
            width: 50px;
            height: 50px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .item-name {
            font-weight: bold;
            font-size: 1.1rem;
            text-shadow: 0 0 3px currentColor;
        }

        .input-group {
            margin-bottom: 10px;
        }

        .input-label {
            display: block;
            font-size: 0.85rem;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }

        .input-field {
            width: 100%;
            padding: 8px 12px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-yellow);
            box-shadow: 0 0 5px rgba(255,235,59,0.3);
        }

        .result {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent-yellow);
            text-align: center;
            margin: 15px 0;
            padding: 10px;
            background: rgba(255,235,59,0.1);
            border-radius: 6px;
            border-left: 4px solid var(--accent-yellow);
        }

        .contacts {
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: rgba(255,255,255,0.05);
            padding: 8px;
            border-radius: 6px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .total-section {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-top: 30px;
            border-top: 2px solid rgba(255,255,255,0.1);
        }

        .total-label {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: var(--text-secondary);
        }

        .total-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--accent-yellow);
            text-shadow: 0 0 5px rgba(255,235,59,0.5);
        }

        /* Modal styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .modal.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            border: 1px solid var(--border-glow);
            box-shadow: 0 0 25px rgba(0,0,0,0.6);
        }

        .modal h2 {
            margin-bottom: 20px;
            color: var(--accent-blue);
            text-align: center;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            color: var(--text-secondary);
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            background: rgba(255,255,255,0.07);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: white;
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-secondary {
            background: #555;
            color: white;
        }

        @media (max-width: 600px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Игровой калькулятор</h1>
        <button class="add-item-btn" id="open-modal">+ Добавить предмет</button>
    </div>

    <div class="container" id="items-container">
        <!-- Динамические блоки -->
    </div>

    <div class="total-section">
        <div class="total-label">Общая стоимость:</div>
        <div class="total-value" id="total-cost">0</div>
    </div>

    <!-- Модальное окно -->
    <div class="modal" id="add-item-modal">
        <div class="modal-content">
            <h2>Добавить новый предмет</h2>
            <div class="form-group">
                <label for="item-name">Название предмета</label>
                <input type="text" id="item-name" placeholder="Например: Зелье невидимости">
            </div>
            <div class="form-group">
                <label for="item-image">URL изображения</label>
                <input type="url" id="item-image" placeholder="https://example.com/icon.png">
            </div>
            <div class="form-group">
                <label for="item-price">Цена за штуку (по умолчанию)</label>
                <input type="number" id="item-price" value="1000" min="0" step="100">
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" id="cancel-btn">Отмена</button>
                <button class="btn btn-primary" id="save-btn">Добавить</button>
            </div>
        </div>
    </div>

    <script>
        // Загрузка сохранённых предметов
        let items = JSON.parse(localStorage.getItem('gameItems')) || [];

        const container = document.getElementById('items-container');
        const totalCostElement = document.getElementById('total-cost');
        const modal = document.getElementById('add-item-modal');
        const openModalBtn = document.getElementById('open-modal');
        const cancelBtn = document.getElementById('cancel-btn');
        const saveBtn = document.getElementById('save-btn');

        // Сохранение в localStorage
        function saveItems() {
            localStorage.setItem('gameItems', JSON.stringify(items));
        }

        // Генерация уникального ID
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        // Рендер одного элемента
        function renderItem(item) {
            const card = document.createElement('div');
            card.className = 'item-card';
            card.dataset.id = item.id;

            card.innerHTML = `
                <button class="delete-btn">×</button>
                <div class="item-header">
                    <div class="item-icon" style="background-image: url('${item.image || 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path fill=\"%23aaa\" d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"/></svg>'}')"></div>
                    <div class="item-name">${item.name}</div>
                </div>
                <div class="input-group">
                    <label class="input-label">Количество:</label>
                    <input type="number" class="input-field quantity" value="0" min="0" step="1">
                </div>
                <div class="input-group">
                    <label class="input-label">Цена за штуку:</label>
                    <input type="number" class="input-field price" value="${item.price || 1000}" min="0" step="100">
                </div>
                <div class="result">0</div>
                <div class="contacts">Контакты продавца или заметки...</div>
            `;

            const deleteBtn = card.querySelector('.delete-btn');
            const quantityInput = card.querySelector('.quantity');
            const priceInput = card.querySelector('.price');
            const resultElement = card.querySelector('.result');

            const updateResult = () => {
                const q = parseInt(quantityInput.value) || 0;
                const p = parseInt(priceInput.value) || 0;
                resultElement.textContent = (q * p).toLocaleString();
                updateTotalCost();
            };

            deleteBtn.addEventListener('click', () => {
                items = items.filter(i => i.id !== item.id);
                saveItems();
                card.remove();
                updateTotalCost();
            });

            quantityInput.addEventListener('input', updateResult);
            priceInput.addEventListener('input', updateResult);

            container.appendChild(card);
        }

        // Рендер всех элементов
        function renderAllItems() {
            container.innerHTML = '';
            items.forEach(renderItem);
            updateTotalCost();
        }

        // Обновление общей суммы
        function updateTotalCost() {
            let total = 0;
            document.querySelectorAll('.result').forEach(el => {
                const num = parseInt(el.textContent.replace(/,/g, '')) || 0;
                total += num;
            });
            totalCostElement.textContent = total.toLocaleString();
        }

        // Открытие/закрытие модалки
        openModalBtn.addEventListener('click', () => modal.classList.add('active'));
        cancelBtn.addEventListener('click', () => modal.classList.remove('active'));

        // Добавление нового предмета
        saveBtn.addEventListener('click', () => {
            const name = document.getElementById('item-name').value.trim();
            const image = document.getElementById('item-image').value.trim();
            const price = parseInt(document.getElementById('item-price').value) || 1000;

            if (!name) {
                alert('Пожалуйста, укажите название предмета.');
                return;
            }

            const newItem = {
                id: generateId(),
                name,
                image: image || '',
                price
            };

            items.push(newItem);
            saveItems();
            renderItem(newItem);
            updateTotalCost();

            // Сброс формы и закрытие
            document.getElementById('item-name').value = '';
            document.getElementById('item-image').value = '';
            document.getElementById('item-price').value = '1000';
            modal.classList.remove('active');
        });

        // Закрытие модалки по клику вне контента
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.remove('active');
            }
        });

        // Инициализация
        renderAllItems();
    </script>
</body>
</html>
